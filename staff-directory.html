<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Staff Directory - UKBRUM</title>
    <link rel="icon" type="image/png" href="images/logo.png">
    <link rel="shortcut icon" type="image/png" href="images/logo.png">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/info-pages.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="js/maintenance-check.js"></script>
    <script src="js/script.js" defer></script>
</head>
<body>
    <header>
        <div class="container">
            <div class="logo">
                <a href="index.html">
                    <img src="images/logo.png" alt="UKBRUM Logo">
                    <h1><span class="full-name">United Kingdom Birmingham Roleplay</span><span class="short-name">UKBRUM</span></h1>
                </a>
            </div>
            <nav>
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="index.html#about">About</a></li>
                    <li><a href="index.html#departments">Departments</a></li>
                    <li><a href="departments/divisions.html">Divisions</a></li>
                    <li><a href="info.html">Info</a></li>
                    <li><a href="index.html#join">Join Us</a></li>
                </ul>
            </nav>
            <div class="theme-toggle">
                <button id="theme-toggle-btn" aria-label="Toggle dark/light mode">
                    <i class="fas fa-sun"></i>
                </button>
            </div>
            <div class="mobile-menu-btn">
                <i class="fas fa-bars"></i>
            </div>
        </div>
    </header>

    <section class="info-hero">
        <div class="container">
            <h1>Staff Directory</h1>
            <p>Meet our dedicated team members</p>
        </div>
    </section>

    <section class="info-section">
        <div class="container">
            <div class="search-container">
                <div class="search-box">
                    <input type="text" id="staffSearch" placeholder="Search staff members...">
                    <i class="fas fa-search"></i>
                </div>
                <div class="filter-buttons">
                    <button class="filter-btn active" data-role="all">All Senior High Ranking Staff</button>
                    <button class="filter-btn" data-role="Founder">Founders</button>
                    <button class="filter-btn" data-role="Co-Founder">Co-Founders</button>
                    <button class="filter-btn" data-role="Assistant Foundership">Assistant Foundership</button>
                    <button class="filter-btn" data-role="Community Leadership">Community Leadership</button>
                </div>
            </div>
            
            <div class="staff-grid" id="staffGrid">
                <div class="loading">Loading staff directory...</div>
            </div>
        </div>
    </section>

<div id="footer"></div>

<script>
  fetch("footer.html")
    .then(response => response.text())
    .then(data => {
      // Inject footer HTML
      document.getElementById("footer").innerHTML = data;

      // Update year dynamically
      document.getElementById("year").textContent = new Date().getFullYear();

      // Update "last updated" in UK format
      const lastUpdatedEl = document.getElementById("last-updated");
      if (lastUpdatedEl) {
        lastUpdatedEl.textContent = new Date(document.lastModified)
          .toLocaleDateString("en-GB", {
            day: "2-digit",
            month: "2-digit",
            year: "numeric"
          });
      }
    })
    .catch(error => console.error("Error loading footer:", error));
</script>

    <script>
        let allStaff = [];
        let filteredStaff = [];

        document.addEventListener('DOMContentLoaded', async function() {
            await loadStaffDirectory();
            setupSearch();
            setupFilters();
        });

        async function loadStaffDirectory() {
            try {
                const response = await fetch('data/staff-directory.json');
                const data = await response.json();
                allStaff = data.staff;
                filteredStaff = [...allStaff];
                displayStaff(filteredStaff);
            } catch (error) {
                document.getElementById('staffGrid').innerHTML = '<div class="error-message">Failed to load staff directory</div>';
            }
        }

        function displayStaff(staff) {
            const grid = document.getElementById('staffGrid');
            
            if (staff.length === 0) {
                grid.innerHTML = '<div class="no-results">No staff members found</div>';
                return;
            }

            grid.innerHTML = staff.map(member => `
                <div class="staff-card" data-role="${member.role}">
                    <div class="staff-avatar">
                        <img src="${member.avatar}" alt="${member.name}" onerror="this.src='images/default-avatar.png'">
                        <div class="role-badge ${member.role.toLowerCase().replace(/\s+/g, '-').replace('&', '')}">${member.role}</div>
                    </div>
                    <div class="staff-info">
                        <h3>${member.name}</h3>
                        <p class="status"><i class="fas fa-circle"></i> ${member.status}</p>
                        <p class="specialization"><i class="fas fa-star"></i> ${member.specialization}</p>
                        <div class="staff-statement">
                            <p><i class="fas fa-quote-left"></i> ${member.statement}</p>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function setupSearch() {
            const searchInput = document.getElementById('staffSearch');
            searchInput.addEventListener('input', function() {
                const query = this.value.toLowerCase();
                filteredStaff = allStaff.filter(member => 
                    member.name.toLowerCase().includes(query) ||
                    member.specialization.toLowerCase().includes(query) ||
                    member.role.toLowerCase().includes(query) ||
                    member.status.toLowerCase().includes(query)
                );
                displayStaff(filteredStaff);
            });
        }

        function setupFilters() {
            const filterButtons = document.querySelectorAll('.filter-btn');
            filterButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    filterButtons.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    const role = this.dataset.role;
                    if (role === 'all') {
                        filteredStaff = [...allStaff];
                    } else {
                        filteredStaff = allStaff.filter(member => member.role === role);
                    }
                    displayStaff(filteredStaff);
                    document.getElementById('staffSearch').value = '';
                });
            });
        }
    </script>
</body>
</html>